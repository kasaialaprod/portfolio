<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <link rel="stylesheet" href="gestion2.css">
    <script src="gestion2.js"></script>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Gestion avanc√©e</title>
</head>
<body>
    <!-- Fond √©toil√© pour l'effet spatial -->
    <div class="space-bg" id="space-bg"></div>
    
    <div class="container">
        <header>
            <h1>Cours PHP - Chapitre 5: Formulaires avanc√©s et s√©curit√©</h1>
            <p class="glowing-text">Formulaires avanc√©s, superglobales et s√©curit√©</p>
        </header>
        
        <div class="nav-bar">
            <a href="#superglobales">Superglobales</a>
            <a href="#securite">S√©curit√©</a>
            <a href="#chiffrement">Chiffrement</a>
        </div>
        
        <div class="content">
            <section id="introduction">
                <h2>Introduction aux superglobales PHP</h2>
                <p>Les superglobales sont des variables pr√©d√©finies en PHP qui sont accessibles depuis n'importe quel scope dans un script.</p>
                
                <div class="flow-diagram">
                    <h3>Cycle de traitement d'une requ√™te HTTP</h3>
                    <div class="flow-steps">
                        <span class="flow-step">Client</span>
                        <span class="flow-arrow">‚Üí</span>
                        <span class="flow-step">Serveur Web</span>
                        <span class="flow-arrow">‚Üí</span>
                        <span class="flow-step">PHP</span>
                        <span class="flow-arrow">‚Üí</span>
                        <span class="flow-step">Superglobales</span>
                    </div>
                </div>
            </section>
            
            <section id="superglobales">
                <h2>Les superglobales PHP</h2>
                
                <div class="superglobal-grid">
                    <div class="superglobal-box">
                        <h4>$_GET</h4>
                        <p><strong>Contient les param√®tres pass√©s dans l'URL</strong></p>
                        <p>Exemple: <code>page.php?nom=value</code></p>
                        <div class="code-block" style="font-size: 0.8em;">
                            $id = $_GET['id'];<br>
                            $search = $_GET['search'];
                        </div>
                    </div>
                    
                    <div class="superglobal-box">
                        <h4>$_POST</h4>
                        <p><strong>Contient les donn√©es de formulaire envoy√©es en POST</strong></p>
                        <p>Utilis√© pour les donn√©es sensibles</p>
                        <div class="code-block" style="font-size: 0.8em;">
                            $username = $_POST['username'];<br>
                            $password = $_POST['password'];
                        </div>
                    </div>
                    
                    <div class="superglobal-box">
                        <h4>$_REQUEST</h4>
                        <p><strong>Combinaison de $_GET, $_POST et $_COOKIE</strong></p>
                        <p>Attention: moins s√©curis√©</p>
                        <div class="code-block" style="font-size: 0.8em;">
                            $data = $_REQUEST['param'];
                        </div>
                    </div>
                    
                    <div class="superglobal-box">
                        <h4>$_SERVER</h4>
                        <p><strong>Informations sur le serveur et l'environnement</strong></p>
                        <p>Headers, chemins, adresses IP</p>
                        <div class="code-block" style="font-size: 0.8em;">
                            $ip = $_SERVER['REMOTE_ADDR'];<br>
                            $method = $_SERVER['REQUEST_METHOD'];
                        </div>
                    </div>
                    
                    <div class="superglobal-box">
                        <h4>$_SESSION</h4>
                        <p><strong>Variables de session persistantes</strong></p>
                        <p>Stock√©es c√¥t√© serveur</p>
                        <div class="code-block" style="font-size: 0.8em;">
                            $_SESSION['user_id'] = 123;<br>
                            $_SESSION['logged_in'] = true;
                        </div>
                    </div>
                    
                    <div class="superglobal-box">
                        <h4>$_COOKIE</h4>
                        <p><strong>Cookies HTTP envoy√©s par le client</strong></p>
                        <p>Stock√©es c√¥t√© client</p>
                        <div class="code-block" style="font-size: 0.8em;">
                            $theme = $_COOKIE['theme'];<br>
                            $language = $_COOKIE['lang'];
                        </div>
                    </div>
                    
                    <div class="superglobal-box">
                        <h4>$_FILES</h4>
                        <p><strong>Informations sur les fichiers upload√©s</strong></p>
                        <p>Nom, type, taille, erreurs</p>
                        <div class="code-block" style="font-size: 0.8em;">
                            $filename = $_FILES['file']['name'];<br>
                            $tmp_name = $_FILES['file']['tmp_name'];
                        </div>
                    </div>
                    
                    <div class="superglobal-box">
                        <h4>$_ENV</h4>
                        <p><strong>Variables d'environnement</strong></p>
                        <p>Configuration du serveur</p>
                        <div class="code-block" style="font-size: 0.8em;">
                            $db_host = $_ENV['DB_HOST'];<br>
                            $api_key = $_ENV['API_KEY'];
                        </div>
                    </div>
                </div>
                
                <h3>Exemple complet d'utilisation des superglobales</h3>
                <div class="code-block">
                    &lt;?php<br>
                    <span style="color: #8d99ae;">// D√©marrer une session</span><br>
                    session_start();<br>
                    <br>
                    <span style="color: #8d99ae;">// Traiter les donn√©es GET</span><br>
                    if (isset($_GET['action'])) {<br>
                    &nbsp;&nbsp;&nbsp;&nbsp;$action = htmlspecialchars($_GET['action']);<br>
                    &nbsp;&nbsp;&nbsp;&nbsp;echo "Action demand√©e: " . $action . "&lt;br&gt;";<br>
                    }<br>
                    <br>
                    <span style="color: #8d99ae;">// Traiter les donn√©es POST</span><br>
                    if ($_SERVER['REQUEST_METHOD'] === 'POST') {<br>
                    &nbsp;&nbsp;&nbsp;&nbsp;$username = filter_var($_POST['username'], FILTER_SANITIZE_STRING);<br>
                    &nbsp;&nbsp;&nbsp;&nbsp;$password = $_POST['password'];<br>
                    &nbsp;&nbsp;&nbsp;&nbsp;<br>
                    &nbsp;&nbsp;&nbsp;&nbsp;<span style="color: #8d99ae;">// Stocker en session</span><br>
                    &nbsp;&nbsp;&nbsp;&nbsp;$_SESSION['username'] = $username;<br>
                    &nbsp;&nbsp;&nbsp;&nbsp;$_SESSION['ip'] = $_SERVER['REMOTE_ADDR'];<br>
                    }<br>
                    <br>
                    <span style="color: #8d99ae;">// V√©rifier les cookies</span><br>
                    if (isset($_COOKIE['preferences'])) {<br>
                    &nbsp;&nbsp;&nbsp;&nbsp;$prefs = json_decode($_COOKIE['preferences'], true);<br>
                    &nbsp;&nbsp;&nbsp;&nbsp;echo "Pr√©f√©rences charg√©es depuis les cookies&lt;br&gt;";<br>
                    }<br>
                    ?&gt;
                </div>
            </section>
            
            <section id="securite-avancee">
                <h2>S√©curit√© avanc√©e des formulaires</h2>
                
                <div class="warning">
                    <p><strong>‚ö†Ô∏è S√âCURIT√â MAXIMALE REQUISE :</strong> Les donn√©es utilisateur sont la principale source de vuln√©rabilit√©s !</p>
                </div>
                
                <h3>Validation approfondie des donn√©es</h3>
                <div class="code-block">
                    &lt;?php<br>
                    function validerFormulaireAvance($donnees) {<br>
                    &nbsp;&nbsp;&nbsp;&nbsp;$erreurs = [];<br>
                    &nbsp;&nbsp;&nbsp;&nbsp;$donnees_valides = [];<br>
                    <br>
                    &nbsp;&nbsp;&nbsp;&nbsp;<span style="color: #8d99ae;">// Validation du nom (lettres, espaces, tirets)</span><br>
                    &nbsp;&nbsp;&nbsp;&nbsp;if (empty($donnees['nom']) || !preg_match('/^[a-zA-Z\s\-]{2,50}$/', $donnees['nom'])) {<br>
                    &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$erreurs[] = "Le nom doit contenir entre 2 et 50 caract√®res alphab√©tiques";<br>
                    &nbsp;&nbsp;&nbsp;&nbsp;} else {<br>
                    &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$donnees_valides['nom'] = htmlspecialchars(trim($donnees['nom']));<br>
                    &nbsp;&nbsp;&nbsp;&nbsp;}<br>
                    <br>
                    &nbsp;&nbsp;&nbsp;&nbsp;<span style="color: #8d99ae;">// Validation email stricte</span><br>
                    &nbsp;&nbsp;&nbsp;&nbsp;if (empty($donnees['email']) || !filter_var($donnees['email'], FILTER_VALIDATE_EMAIL)) {<br>
                    &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$erreurs[] = "L'email n'est pas valide";<br>
                    &nbsp;&nbsp;&nbsp;&nbsp;} else {<br>
                    &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$donnees_valides['email'] = filter_var($donnees['email'], FILTER_SANITIZE_EMAIL);<br>
                    &nbsp;&nbsp;&nbsp;&nbsp;}<br>
                    <br>
                    &nbsp;&nbsp;&nbsp;&nbsp;<span style="color: #8d99ae;">// Validation √¢ge (entre 1 et 120)</span><br>
                    &nbsp;&nbsp;&nbsp;&nbsp;if (!isset($donnees['age']) || !filter_var($donnees['age'], FILTER_VALIDATE_INT, <br>
                    &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;['options' => ['min_range' => 1, 'max_range' => 120]])) {<br>
                    &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$erreurs[] = "L'√¢ge doit √™tre un nombre entre 1 et 120";<br>
                    &nbsp;&nbsp;&nbsp;&nbsp;} else {<br>
                    &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$donnees_valides['age'] = (int)$donnees['age'];<br>
                    &nbsp;&nbsp;&nbsp;&nbsp;}<br>
                    <br>
                    &nbsp;&nbsp;&nbsp;&nbsp;return ['erreurs' => $erreurs, 'donnees' => $donnees_valides];<br>
                    }<br>
                    <br>
                    <span style="color: #8d99ae;">// Utilisation</span><br>
                    if ($_SERVER['REQUEST_METHOD'] === 'POST') {<br>
                    &nbsp;&nbsp;&nbsp;&nbsp;$resultat = validerFormulaireAvance($_POST);<br>
                    &nbsp;&nbsp;&nbsp;&nbsp;if (empty($resultat['erreurs'])) {<br>
                    &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: #8d99ae;">// Traitement des donn√©es valid√©es</span><br>
                    &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;traiterDonnees($resultat['donnees']);<br>
                    &nbsp;&nbsp;&nbsp;&nbsp;} else {<br>
                    &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;afficherErreurs($resultat['erreurs']);<br>
                    &nbsp;&nbsp;&nbsp;&nbsp;}<br>
                    }<br>
                    ?&gt;
                </div>
                
                <h3>Protection CSRF (Cross-Site Request Forgery)</h3>
                <div class="code-block">
                    &lt;?php<br>
                    session_start();<br>
                    <br>
                    <span style="color: #8d99ae;">// G√©n√©rer un token CSRF</span><br>
                    function genererTokenCSRF() {<br>
                    &nbsp;&nbsp;&nbsp;&nbsp;if (empty($_SESSION['csrf_token'])) {<br>
                    &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$_SESSION['csrf_token'] = bin2hex(random_bytes(32));<br>
                    &nbsp;&nbsp;&nbsp;&nbsp;}<br>
                    &nbsp;&nbsp;&nbsp;&nbsp;return $_SESSION['csrf_token'];<br>
                    }<br>
                    <br>
                    <span style="color: #8d99ae;">// Valider le token CSRF</span><br>
                    function validerTokenCSRF($token) {<br>
                    &nbsp;&nbsp;&nbsp;&nbsp;return isset($_SESSION['csrf_token']) && <br>
                    &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;hash_equals($_SESSION['csrf_token'], $token);<br>
                    }<br>
                    <br>
                    <span style="color: #8d99ae;">// Dans le formulaire HTML</span><br>
                    ?&gt;<br>
                    &lt;form method="post"&gt;<br>
                    &nbsp;&nbsp;&nbsp;&nbsp;&lt;input type="hidden" name="csrf_token" value="&lt;?php echo genererTokenCSRF(); ?&gt;"&gt;<br>
                    &nbsp;&nbsp;&nbsp;&nbsp;&lt;!-- autres champs --&gt;<br>
                    &lt;/form&gt;<br>
                    <br>
                    &lt;?php<br>
                    <span style="color: #8d99ae;">// Dans le traitement du formulaire</span><br>
                    if ($_SERVER['REQUEST_METHOD'] === 'POST') {<br>
                    &nbsp;&nbsp;&nbsp;&nbsp;if (!validerTokenCSRF($_POST['csrf_token'])) {<br>
                    &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;die("Erreur de s√©curit√©: Token CSRF invalide");<br>
                    &nbsp;&nbsp;&nbsp;&nbsp;}<br>
                    &nbsp;&nbsp;&nbsp;&nbsp;<span style="color: #8d99ae;">// Traitement s√©curis√©...</span><br>
                    }<br>
                    ?&gt;
                </div>
            </section>
            
            <section id="chiffrement">
                <h2>Chiffrement des mots de passe</h2>
                
                <div class="info">
                    <p><strong>üí° IMPORTANT :</strong> Ne stockez jamais les mots de passe en clair ! Utilisez toujours des fonctions de hachage s√©curis√©es.</p>
                </div>
                
                <h3>√âvolution du hachage des mots de passe</h3>
                <div class="hash-comparison">
                    <div class="hash-box">
                        <h4>‚ùå MD5 (DANGEREUX)</h4>
                        <p>Rapide, vuln√©rable aux attaques</p>
                        <div class="code-block" style="font-size: 0.8em;">
                            $hash = md5($password);<br>
                            <span style="color: #f72585;">// √Ä NE PLUS UTILISER!</span>
                        </div>
                    </div>
                    
                    <div class="hash-box">
                        <h4>‚ö†Ô∏è SHA1 (OBSOL√àTE)</h4>
                        <p>Plus s√©curis√© que MD5 mais d√©pass√©</p>
                        <div class="code-block" style="font-size: 0.8em;">
                            $hash = sha1($password);<br>
                            <span style="color: #f72585;">// D√âCONSEILL√â</span>
                        </div>
                    </div>
                    
                    <div class="hash-box">
                        <h4>‚úÖ password_hash() (RECOMMAND√â)</h4>
                        <p>Lent, sal√©, adaptatif</p>
                        <div class="code-block" style="font-size: 0.8em;">
                            $hash = password_hash(<br>
                            &nbsp;&nbsp;$password,<br>
                            &nbsp;&nbsp;PASSWORD_DEFAULT<br>
                            );
                        </div>
                    </div>
                </div>
                
                <h3>Algorithmes de hachage modernes</h3>
                <table class="algorithm-table">
                    <tr>
                        <th>Algorithme</th>
                        <th>Description</th>
                        <th>Utilisation</th>
                    </tr>
                    <tr>
                        <td><strong>PASSWORD_DEFAULT</strong></td>
                        <td>Utilise bcrypt (actuellement recommand√©)</td>
                        <td>Recommand√© pour la plupart des cas</td>
                    </tr>
                    <tr>
                        <td><strong>PASSWORD_BCRYPT</strong></td>
                        <td>Algorithme bcrypt avec co√ªt param√©trable</td>
                        <td>Bon √©quilibre s√©curit√©/performance</td>
                    </tr>
                    <tr>
                        <td><strong>PASSWORD_ARGON2I</strong></td>
                        <td>Argon2i (gagnant du Password Hashing Competition)</td>
                        <td>Tr√®s s√©curis√©, n√©cessite PHP 7.2+</td>
                    </tr>
                    <tr>
                        <td><strong>PASSWORD_ARGON2ID</strong></td>
                        <td>Argon2id (version hybride)</td>
                        <td>Le plus s√©curis√©, PHP 7.3+</td>
                    </tr>
                </table>
                
                <h3>Impl√©mentation compl√®te du hachage s√©curis√©</h3>
                <div class="code-block">
                    &lt;?php<br>
                    class GestionnaireMotDePasse {<br>
                    &nbsp;&nbsp;&nbsp;&nbsp;private $options;<br>
                    <br>
                    &nbsp;&nbsp;&nbsp;&nbsp;public function __construct() {<br>
                    &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: #8d99ae;">// Configuration du co√ªt de hachage (10-12 recommand√©)</span><br>
                    &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$this-&gt;options = [<br>
                    &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;'cost' =&gt; 12,<br>
                    &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;];<br>
                    &nbsp;&nbsp;&nbsp;&nbsp;}<br>
                    <br>
                    &nbsp;&nbsp;&nbsp;&nbsp;<span style="color: #8d99ae;">// Hacher un mot de passe</span><br>
                    &nbsp;&nbsp;&nbsp;&nbsp;public function hacher($motDePasse) {<br>
                    &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return password_hash($motDePasse, PASSWORD_DEFAULT, $this-&gt;options);<br>
                    &nbsp;&nbsp;&nbsp;&nbsp;}<br>
                    <br>
                    &nbsp;&nbsp;&nbsp;&nbsp;<span style="color: #8d99ae;">// V√©rifier un mot de passe</span><br>
                    &nbsp;&nbsp;&nbsp;&nbsp;public function verifier($motDePasse, $hash) {<br>
                    &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return password_verify($motDePasse, $hash);<br>
                    &nbsp;&nbsp;&nbsp;&nbsp;}<br>
                    <br>
                    &nbsp;&nbsp;&nbsp;&nbsp;<span style="color: #8d99ae;">// V√©rifier si un hash doit √™tre r√©hach√© (apr√®s changement d'algorithme)</span><br>
                    &nbsp;&nbsp;&nbsp;&nbsp;public function doitEtreRehache($hash) {<br>
                    &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return password_needs_rehash($hash, PASSWORD_DEFAULT, $this-&gt;options);<br>
                    &nbsp;&nbsp;&nbsp;&nbsp;}<br>
                    }<br>
                    <br>
                    <span style="color: #8d99ae;">// Utilisation</span><br>
                    $gestionnaire = new GestionnaireMotDePasse();<br>
                    <br>
                    <span style="color: #8d99ae;">// Inscription</span><br>
                    $motDePasseClair = "MonMotDePasseSecret123";<br>
                    $hash = $gestionnaire-&gt;hacher($motDePasseClair);<br>
                                        <span style="color: #8d99ae;">// Stocker $hash dans la base de donn√©es</span><br>
                    <br>
                    <span style="color: #8d99ae;">// Connexion</span><br>
                    $motDePasseSaisi = "MonMotDePasseSecret123";<br>
                    $hashEnBase = "..."; <span style="color: #8d99ae;">// R√©cup√©r√© de la BDD</span><br>
                    if ($gestionnaire-&gt;verifier($motDePasseSaisi, $hashEnBase)) {<br>
                    &nbsp;&nbsp;&nbsp;&nbsp;echo "Mot de passe correct!";<br>
                    &nbsp;&nbsp;&nbsp;&nbsp;<span style="color: #8d99ae;">// V√©rifier si le hash doit √™tre mis √† jour</span><br>
                    &nbsp;&nbsp;&nbsp;&nbsp;if ($gestionnaire-&gt;doitEtreRehache($hashEnBase)) {<br>
                    &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$nouveauHash = $gestionnaire-&gt;hacher($motDePasseSaisi);<br>
                    &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: #8d99ae;">// Mettre √† jour le hash en base</span><br>
                    &nbsp;&nbsp;&nbsp;&nbsp;}<br>
                    } else {<br>
                    &nbsp;&nbsp;&nbsp;&nbsp;echo "Mot de passe incorrect!";<br>
                    }<br>
                    ?&gt;
                </div>
            </section>

            <section id="sessions-cookies">
                <h2>Gestion avanc√©e des sessions et cookies</h2>

                <h3>S√©curisation des sessions</h3>
                <div class="code-block">
                    &lt;?php<br>
                    <span style="color: #8d99ae;">// Configuration s√©curis√©e des sessions</span><br>
                    ini_set('session.cookie_httponly', 1);<br>
                    ini_set('session.cookie_secure', 1); <span style="color: #8d99ae;">// En production avec HTTPS</span><br>
                    ini_set('session.use_strict_mode', 1);<br>
                    <br>
                    session_start();<br>
                    <br>
                    <span style="color: #8d99ae;">// R√©g√©n√©rer l'ID de session pour √©viter le fixation</span><br>
                    if (!isset($_SESSION['initiated'])) {<br>
                    &nbsp;&nbsp;&nbsp;&nbsp;session_regenerate_id(true);<br>
                    &nbsp;&nbsp;&nbsp;&nbsp;$_SESSION['initiated'] = true;<br>
                    }<br>
                    <br>
                    <span style="color: #8d99ae;">// V√©rifier l'adresse IP pour d√©tecter le vol de session</span><br>
                    if (isset($_SESSION['ip']) && $_SESSION['ip'] !== $_SERVER['REMOTE_ADDR']) {<br>
                    &nbsp;&nbsp;&nbsp;&nbsp;session_destroy();<br>
                    &nbsp;&nbsp;&nbsp;&nbsp;die("Suspicion de vol de session");<br>
                    }<br>
                    <br>
                    <span style="color: #8d99ae;">// Stocker l'IP dans la session</span><br>
                    $_SESSION['ip'] = $_SERVER['REMOTE_ADDR'];<br>
                    <br>
                    <span style="color: #8d99ae;">// Ajouter un timestamp pour expiration</span><br>
                    $_SESSION['last_activity'] = time();<br>
                    <br>
                    <span style="color: #8d99ae;">// V√©rifier l'expiration de session (30 minutes)</span><br>
                    if (isset($_SESSION['last_activity']) && <br>
                    &nbsp;&nbsp;&nbsp;&nbsp;(time() - $_SESSION['last_activity'] > 1800)) {<br>
                    &nbsp;&nbsp;&nbsp;&nbsp;session_destroy();<br>
                    &nbsp;&nbsp;&nbsp;&nbsp;die("Session expir√©e");<br>
                    }<br>
                    ?&gt;
                </div>

                <h3>Cookies s√©curis√©s</h3>
                <div class="code-block">
                    &lt;?php<br>
                    function setSecureCookie($name, $value, $expire = 0) {<br>
                    &nbsp;&nbsp;&nbsp;&nbsp;$options = [<br>
                    &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;'expires' => $expire,<br>
                    &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;'path' => '/',<br>
                    &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;'domain' => $_SERVER['HTTP_HOST'],<br>
                    &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;'secure' => true, <span style="color: #8d99ae;">// HTTPS seulement</span><br>
                    &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;'httponly' => true, <span style="color: #8d99ae;">// Inaccessible en JavaScript</span><br>
                    &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;'samesite' => 'Strict' <span style="color: #8d99ae;">// Protection CSRF</span><br>
                    &nbsp;&nbsp;&nbsp;&nbsp;];<br>
                    &nbsp;&nbsp;&nbsp;&nbsp;setcookie($name, $value, $options);<br>
                    }<br>
                    <br>
                    <span style="color: #8d99ae;">// Utilisation</span><br>
                    setSecureCookie('user_prefs', json_encode(['theme' => 'dark']), time() + 86400);<br>
                    ?&gt;
                </div>
            </section>

            <section id="upload-securise">
                <h2>Upload s√©curis√© de fichiers</h2>

                <div class="code-block">
                    &lt;?php<br>
                    class UploadHandler {<br>
                    &nbsp;&nbsp;&nbsp;&nbsp;private $allowedTypes = ['image/jpeg', 'image/png', 'application/pdf'];<br>
                    &nbsp;&nbsp;&nbsp;&nbsp;private $maxSize = 5 * 1024 * 1024; <span style="color: #8d99ae;">// 5MB</span><br>
                    &nbsp;&nbsp;&nbsp;&nbsp;private $uploadDir = 'uploads/';<br>
                    <br>
                    &nbsp;&nbsp;&nbsp;&nbsp;public function handleUpload($file) {<br>
                    &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: #8d99ae;">// V√©rifier les erreurs</span><br>
                    &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if ($file['error'] !== UPLOAD_ERR_OK) {<br>
                    &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;throw new Exception('Erreur lors de l\'upload');<br>
                    &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>
                    <br>
                    &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: #8d99ae;">// V√©rifier la taille</span><br>
                    &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if ($file['size'] > $this->maxSize) {<br>
                    &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;throw new Exception('Fichier trop volumineux');<br>
                    &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>
                    <br>
                    &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: #8d99ae;">// V√©rifier le type MIME</span><br>
                    &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$finfo = finfo_open(FILEINFO_MIME_TYPE);<br>
                    &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$mime = finfo_file($finfo, $file['tmp_name']);<br>
                    &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;finfo_close($finfo);<br>
                    <br>
                    &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if (!in_array($mime, $this->allowedTypes)) {<br>
                    &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;throw new Exception('Type de fichier non autoris√©');<br>
                    &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>
                    <br>
                    &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: #8d99ae;">// G√©n√©rer un nom de fichier s√©curis√©</span><br>
                    &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$extension = pathinfo($file['name'], PATHINFO_EXTENSION);<br>
                    &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$safeName = bin2hex(random_bytes(16)) . '.' . $extension;<br>
                    &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$destination = $this->uploadDir . $safeName;<br>
                    <br>
                    &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: #8d99ae;">// D√©placer le fichier</span><br>
                    &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if (!move_uploaded_file($file['tmp_name'], $destination)) {<br>
                    &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;throw new Exception('Erreur lors du d√©placement du fichier');<br>
                    &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>
                    <br>
                    &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return $safeName;<br>
                    &nbsp;&nbsp;&nbsp;&nbsp;}<br>
                    }<br>
                    <br>
                    <span style="color: #8d99ae;">// Utilisation</span><br>
                    if ($_SERVER['REQUEST_METHOD'] === 'POST' && isset($_FILES['fichier'])) {<br>
                    &nbsp;&nbsp;&nbsp;&nbsp;try {<br>
                    &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$uploader = new UploadHandler();<br>
                    &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$fileName = $uploader->handleUpload($_FILES['fichier']);<br>
                    &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;echo "Fichier upload√© avec succ√®s: " . $fileName;<br>
                    &nbsp;&nbsp;&nbsp;&nbsp;} catch (Exception $e) {<br>
                    &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;echo "Erreur: " . $e->getMessage();<br>
                    &nbsp;&nbsp;&nbsp;&nbsp;}<br>
                    }<br>
                    ?&gt;
                </div>
            </section>

            <section id="demo-interactive">
                <h2>D√©monstration interactive de s√©curit√©</h2>

                <div class="interactive-demo">
                    <h3>Testez le hachage de mots de passe</h3>
                    
                    <div class="form-group">
                        <label class="form-label" for="password-input">Mot de passe √† tester :</label>
                        <input class="form-input" type="password" id="password-input" value="MonMotDePasse123">
                    </div>

                    <div class="demo-controls">
                        <button class="demo-btn" onclick="testerHachage()">Tester le hachage</button>
                        <button class="demo-btn" onclick="comparerAlgorithmes()">Comparer les algorithmes</button>
                        <button class="demo-btn" onclick="genererTokenCSRF()">G√©n√©rer token CSRF</button>
                    </div>

                    <div class="console-output" id="security-result">
                        <span style="color: #8d99ae;">// Les r√©sultats de s√©curit√© appara√Ætront ici</span>
                    </div>
                </div>
            </section>

            <section id="best-practices">
                <h2>Checklist de s√©curit√©</h2>

                <table class="security-table">
                    <tr>
                        <th>Risque</th>
                        <th>Protection</th>
                        <th>Impl√©mentation</th>
                    </tr>
                    <tr>
                        <td><strong>XSS</strong></td>
                        <td>√âchappement HTML</td>
                        <td>htmlspecialchars(), htmlentities()</td>
                    </tr>
                    <tr>
                        <td><strong>SQL Injection</strong></td>
                        <td>Requ√™tes pr√©par√©es</td>
                        <td>PDO, MySQLi pr√©par√©</td>
                    </tr>
                    <tr>
                        <td><strong>CSRF</strong></td>
                        <td>Tokens synchronisers</td>
                        <td>Tokens de session uniques</td>
                    </tr>
                    <tr>
                        <td><strong>Session Hijacking</strong></td>
                        <td>R√©g√©n√©ration d'ID</td>
                        <td>session_regenerate_id()</td>
                    </tr>
                    <tr>
                        <td><strong>Password Theft</strong></td>
                        <td>Hachage s√©curis√©</td>
                        <td>password_hash() / password_verify()</td>
                    </tr>
                    <tr>
                        <td><strong>File Upload Attacks</strong></td>
                        <td>Validation stricte</td>
                        <td>V√©rification MIME, extension</td>
                    </tr>
                    <tr>
                        <td><strong>Clickjacking</strong></td>
                        <td>Headers de s√©curit√©</td>
                        <td>X-Frame-Options, CSP</td>
                    </tr>
                </table>

                <h3>Headers de s√©curit√© HTTP</h3>
                <div class="code-block">
                    &lt;?php<br>
                    <span style="color: #8d99ae;">// Headers de s√©curit√© recommand√©s</span><br>
                    header('X-Frame-Options: DENY'); <span style="color: #8d99ae;">// Anti-clickjacking</span><br>
                    header('X-XSS-Protection: 1; mode=block');<br>
                    header('X-Content-Type-Options: nosniff');<br>
                    header('Referrer-Policy: strict-origin-when-cross-origin');<br>
                    <br>
                    <span style="color: #8d99ae;">// Content Security Policy (CSP)</span><br>
                    header("Content-Security-Policy: default-src 'self'; script-src 'self' 'unsafe-inline'");<br>
                    <br>
                    <span style="color: #8d99ae;">// HSTS (HTTPS Strict Transport Security)</span><br>
                    header('Strict-Transport-Security: max-age=31536000; includeSubDomains');<br>
                    ?&gt;
                </div>
            </section>
        </div>

        <footer>
            <p>Cours PHP - Chapitre 5 | Formulaires avanc√©s, superglobales et s√©curit√©</p>
            <p>Prochain chapitre: <a href="../base_de_donnee/bdd_mysql.html">Bases de donn√©es et MySQL</a></p>
        </footer>
    </div>
</body>
</html>